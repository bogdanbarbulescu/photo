<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery - Bogdan Barbulescu Photography</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    <style>
        /* --- Add styles for Gallery Modal --- */
        #galleryModal .modal-dialog {
            max-width: 90vw;
            /* Allow modal to be wider on large screens */
        }

        @media (min-width: 992px) {
            #galleryModal .modal-dialog {
                max-width: 800px;
                /* Or your preferred max width */
            }
        }

        #modalImage {
            max-width: 100%;
            /* Ensure image doesn't overflow horizontally */
            max-height: 75vh;
            /* Limit image height */
            object-fit: contain;
            /* Scale image while preserving aspect ratio */
            display: block;
            margin: 0 auto;
            cursor: grab;
            /* Indicate swipe possibility */
        }

        #modalImage:active {
            cursor: grabbing;
        }

        #galleryModal .modal-body button {
            z-index: 10;
            opacity: 0.7;
            transition: opacity 0.2s ease-in-out;
        }

        #galleryModal .modal-body button:hover {
            opacity: 1;
        }

        #galleryModal .modal-header,
        #galleryModal .modal-footer {
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* Prevent selecting image during swipe */
        #modalImage {
            user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            -moz-user-select: none;
            -webkit-user-drag: none;
        }
    </style>
</head>

<body>

    <!-- Navigation Bar (Corrected Structure) -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
        <div class="container">
            <!-- Use white logo version for dark navbar -->
            <a class="navbar-brand" href="index.html#page-top">
                <img src="assets/images/logo.png" alt="Bogdan Barbulescu Photography Logo" height="50">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="gallery.html">Gallery</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="journal.html">Journal</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#about">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content - Gallery Page -->
    <main class="page-content bg-dark" style="padding-top: 8rem;">
        <section id="portfolio-gallery" class="py-5">
            <div class="container">
                <h2 class="text-center mb-4 text-light">Gallery</h2>


                <!-- Filter Buttons -->
                <div id="gallery-filters" class="text-center mb-5">
                    <button class="btn btn-outline-light btn-sm filter-button active-filter"
                        data-filter="all">All</button>
                    <button class="btn btn-outline-light btn-sm filter-button"
                        data-filter="mountains">Mountains</button>
                    <button class="btn btn-outline-light btn-sm filter-button" data-filter="forests">Forests</button>
                    <button class="btn btn-outline-light btn-sm filter-button" data-filter="sunrises">Sunrises</button>
                    <button class="btn btn-outline-light btn-sm filter-button" data-filter="sunsets">Sunsets</button>
                    <button class="btn btn-outline-light btn-sm filter-button"
                        data-filter="waterfalls">Waterfalls</button>
                    <button class="btn btn-outline-light btn-sm filter-button" data-filter="aurora">Aurora</button>
                    <button class="btn btn-outline-light btn-sm filter-button" data-filter="bw">B&W</button>
                    <!-- Add more categories as needed -->
                </div>

                <!-- Gallery Grid -->
                <div class="row g-4 portfolio-container"> <!-- Using g-4 for spacing -->

                    <!-- Item 1: Mountains -->
                    <div class="col-lg-4 col-sm-6 portfolio-item mountains">
                        <a class="portfolio-box" href="assets/images/bucegi.jpg"
                            data-large-src="assets/images/bucegi.jpg" data-category="Mountains" data-title="Giants">
                            <img class="img-fluid" src="assets/images/bucegi.jpg" alt="Bucegi" />
                            <div class="portfolio-box-caption">
                                <div class="project-category text-white-50">Mountains</div>
                                <div class="project-name">Giants</div>
                            </div>
                        </a>
                    </div>

                    <!-- Item 2: Waterfalls -->
                    <div class="col-lg-4 col-sm-6 portfolio-item waterfalls">
                        <a class="portfolio-box" href="assets/images/IMG_hero.webp"
                            data-large-src="assets/images/IMG_hero.webp" data-category="Waterfalls"
                            data-title="Waterfalls">
                            <img class="img-fluid" src="assets/images/IMG_hero.webp" alt="Bucegi" />
                            <div class="portfolio-box-caption">
                                <div class="project-category text-white-50">Waterfalls</div>
                                <div class="project-name">Waterfalls</div>
                            </div>
                        </a>
                    </div>

                    <!-- Item 3: Mountains -->
                    <div class="col-lg-4 col-sm-6 portfolio-item mountains">
                        <a class="portfolio-box" href="assets/images/frozen.jpg"
                            data-large-src="assets/images/frozen.jpg" data-category="Mountains" data-title="Winter">
                            <img class="img-fluid" src="assets/images/frozen.jpg" alt="Snowy Peaks" />
                            <div class="portfolio-box-caption">
                                <div class="project-category text-white-50">Mountains</div>
                                <div class="project-name">Giants</div>
                            </div>
                        </a>
                    </div>

                    <!-- Item 4: Aurora  -->
                    <div class="col-lg-4 col-sm-6 portfolio-item aurora">
                        <a class="portfolio-box" href="assets/images/aurora.jpg"
                            data-large-src="assets/images/aurora.jpg" data-category="Aurora"
                            data-title="Chasing Aurora">
                            <img class="img-fluid" src="assets/images/aurora.jpg" alt="Chasing Aurora" />
                            <div class="portfolio-box-caption">
                                <div class="project-category text-white-50">Aurora</div>
                                <div class="project-name">Chasing Aurora</div>
                            </div>
                        </a>
                    </div>

                    <!-- Item 5: Sunrises  -->
                    <div class="col-lg-4 col-sm-6 portfolio-item sunrises">
                        <a class="portfolio-box" href="assets/images/nature4.webp"
                            data-large-src="assets/images/nature4.webp" data-category="Sunrises"
                            data-title="Coastal Sunrise"> <!-- Changed title -->
                            <img class="img-fluid" src="assets/images/nature4.webp" alt="Sunrises" />
                            <div class="portfolio-box-caption">
                                <div class="project-category text-white-50">Sunrises</div>
                                <div class="project-name">Sunrises</div>
                            </div>
                        </a>
                    </div>
                    
                    <!-- Item 6: Sunsets  -->
                    <div class="col-lg-4 col-sm-6 portfolio-item sunsets">
                        <a class="portfolio-box" href="assets/images/road.jpg" data-large-src="assets/images/road.jpg"
                            data-category="Sunsets" data-title="Desert Sunset"> <!-- Changed title -->
                            <img class="img-fluid" src="assets/images/road.jpg" alt="Desert Sunset" />
                            <div class="portfolio-box-caption">
                                <div class="project-category text-white-50">Sunsets</div>
                                <div class="project-name">Sunset</div>
                            </div>
                        </a>
                    </div>

                    <!-- === IMPORTANT: Add data-* attributes to ALL your items === -->

                </div> <!-- /.row .portfolio-container -->
            </div> <!-- /.container -->
        </section>
    </main>

    <!-- Footer -->
    <footer class="py-5 bg-dark text-center text-white-50">
        <div class="container">
            <div class="mb-3">
                <a href="#" class="text-white-50 me-3"><i class="fab fa-instagram fa-lg"></i></a>
                <a href="#" class="text-white-50 me-3"><i class="fab fa-youtube fa-lg"></i></a>
                <!-- Match other pages -->
                <a href="#" class="text-white-50"><i class="fab fa-facebook-f fa-lg"></i></a>
            </div>
            <p class="mb-0 small">© 2025 Bogdan Barbulescu Photography. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- Gallery Modal -->
    <div class="modal fade" id="galleryModal" tabindex="-1" aria-labelledby="galleryModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content bg-dark text-light">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title" id="modalTitle">Image Title</h5>

                    <!-- === ADD FULLSCREEN BUTTON HERE === -->
                    <button type="button" class="btn btn-outline-light btn-sm ms-auto me-2" id="modalFullscreenBtn"
                        aria-label="Toggle fullscreen">
                        <i class="fas fa-expand"></i> <!-- Initial icon -->
                    </button>
                    <!-- === END FULLSCREEN BUTTON === -->

                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body text-center position-relative">
                    <img src="" class="img-fluid" id="modalImage" alt="Enlarged Gallery Image">

                    <!-- Carousel Controls -->
                    <button
                        class="btn btn-outline-light position-absolute top-50 start-0 translate-middle-y ms-2 d-none d-md-block"
                        type="button" id="modalPrev" aria-label="Previous image">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button
                        class="btn btn-outline-light position-absolute top-50 end-0 translate-middle-y me-2 d-none d-md-block"
                        type="button" id="modalNext" aria-label="Next image">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="modal-footer border-secondary justify-content-center">
                    <p id="modalCaption" class="mb-0 text-white-75 small">Category</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>

    <!-- Custom JS -->
    <script>
        // --- Consolidated script.js content for this page ---

        document.addEventListener('DOMContentLoaded', () => {

            // --- Configuration ---
            const SCROLL_OFFSET_BUFFER = 50;
            const SWIPE_THRESHOLD = 50; // Min pixels for swipe gesture

            // --- Cache Selectors ---
            const mainNav = document.getElementById('mainNav');
            const navbarToggler = document.querySelector('.navbar-toggler');
            const navbarCollapse = document.querySelector('.navbar-collapse');
            const galleryModalElement = document.getElementById('galleryModal');
            let modalInstance = null;
            let modalImageElement = null;
            let modalTitleElement = null;
            let modalCaptionElement = null;
            let modalPrevButton = null;
            let modalNextButton = null;

            if (galleryModalElement) {
                modalInstance = new bootstrap.Modal(galleryModalElement);
                modalImageElement = document.getElementById('modalImage');
                modalTitleElement = document.getElementById('modalTitle');
                modalCaptionElement = document.getElementById('modalCaption');
                modalPrevButton = document.getElementById('modalPrev');
                modalNextButton = document.getElementById('modalNext');
            }

            // --- Gallery Data & State ---
            let galleryData = [];
            let currentImageIndex = 0;
            let touchStartX = 0;
            let touchEndX = 0;

            // --- Initialize Features ---
            if (mainNav) {
                initNavbarShrink(mainNav);
            }
            initImageProtection();
            initSmoothScroll(mainNav);
            initScrollspy(mainNav, SCROLL_OFFSET_BUFFER); // Won't do much on gallery page unless sections added
            initGalleryFilter();
            initGalleryModal(); // Initializes modal and collects data

            // --- Feature Functions ---

            function initNavbarShrink(navElement) {
                const shrink = () => {
                    if (!navElement) return;
                    if (window.pageYOffset === 0) {
                        navElement.classList.remove('navbar-scrolled');
                    } else {
                        navElement.classList.add('navbar-scrolled');
                    }
                };
                shrink();
                document.addEventListener('scroll', shrink);
            }

            function initImageProtection() {
                const protectedImages = document.querySelectorAll('img');
                protectedImages.forEach(img => {
                    img.addEventListener('contextmenu', (e) => e.preventDefault());
                    img.style.userDrag = 'none';
                    img.style.webkitUserDrag = 'none';
                });
            }

            function initSmoothScroll(navElement) {
                document.querySelectorAll('a.nav-link[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        const targetId = this.getAttribute('href');
                        if (targetId.length <= 1) return;
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            e.preventDefault();
                            const navbarHeight = navElement ? navElement.offsetHeight : 0;
                            const elementPosition = targetElement.getBoundingClientRect().top;
                            const offsetPosition = window.pageYOffset + elementPosition - navbarHeight;
                            window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                            if (navbarCollapse && navbarCollapse.classList.contains('show') && navbarToggler) {
                                navbarToggler.click();
                            }
                        }
                    });
                });
            }

            function initScrollspy(navElement, offsetBuffer) {
                // Scrollspy requires sections with IDs on the page to work.
                // Might not be relevant for the gallery page itself unless you add sections.
                const sections = document.querySelectorAll('main section[id]');
                const navLinks = document.querySelectorAll('#navbarNav .nav-link[href^="#"]');
                if (sections.length === 0 || navLinks.length === 0) return;

                const updateActiveLink = () => { /* ... scrollspy logic ... */ }; // (Keep logic if needed)
                window.addEventListener('scroll', updateActiveLink);
                updateActiveLink();
            }

            function initGalleryFilter() {
                const filterContainer = document.querySelector('#gallery-filters');
                const galleryItems = document.querySelectorAll('.portfolio-container .portfolio-item');
                if (!filterContainer || galleryItems.length === 0) return;

                // Define .hide-item in style.css: .hide-item { display: none !important; }

                filterContainer.addEventListener('click', (event) => {
                    if (event.target.classList.contains('filter-button')) {
                        const clickedButton = event.target;
                        filterContainer.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active-filter'));
                        clickedButton.classList.add('active-filter');
                        const filterValue = clickedButton.getAttribute('data-filter');
                        galleryItems.forEach(item => {
                            if (filterValue === 'all' || item.classList.contains(filterValue)) {
                                item.classList.remove('hide-item');
                            } else {
                                item.classList.add('hide-item');
                            }
                        });
                    }
                });
                // Ensure initial state matches active filter
                const initialActiveFilter = filterContainer.querySelector('.filter-button.active-filter');
                if (initialActiveFilter && initialActiveFilter.getAttribute('data-filter') !== 'all') {
                    const initialFilterValue = initialActiveFilter.getAttribute('data-filter');
                    galleryItems.forEach(item => {
                        if (!item.classList.contains(initialFilterValue)) {
                            item.classList.add('hide-item');
                        }
                    });
                }
            }

            /**
             * Initializes the modal carousel for the gallery, including swipe.
             */
            function initGalleryModal() {
                if (!galleryModalElement || !modalImageElement || !modalPrevButton || !modalNextButton) return;

                const portfolioBoxes = document.querySelectorAll('.portfolio-container .portfolio-box');
                galleryData = []; // Reset

                portfolioBoxes.forEach((box, index) => {
                    galleryData.push({
                        largeSrc: box.getAttribute('data-large-src') || box.href,
                        title: box.getAttribute('data-title') || 'Image',
                        category: box.getAttribute('data-category') || ''
                    });
                    box.setAttribute('data-index', index);

                    box.addEventListener('click', (e) => {
                        e.preventDefault();
                        currentImageIndex = parseInt(e.currentTarget.getAttribute('data-index'), 10);
                        updateModalContent(currentImageIndex);
                        modalInstance.show();
                    });
                });

                // Desktop Navigation
                modalPrevButton.addEventListener('click', showPreviousImage);
                modalNextButton.addEventListener('click', showNextImage);

                // Keyboard Navigation
                galleryModalElement.addEventListener('keydown', (e) => {
                    if (modalInstance && galleryModalElement.classList.contains('show')) { // Only when modal is shown
                        if (e.key === 'ArrowLeft') showPreviousImage();
                        else if (e.key === 'ArrowRight') showNextImage();
                    }
                });

                // Mobile Swipe Navigation Listeners (on the image itself)
                modalImageElement.addEventListener('touchstart', handleTouchStart, false);
                modalImageElement.addEventListener('touchmove', handleTouchMove, false);
                modalImageElement.addEventListener('touchend', handleTouchEnd, false);
            }

            function updateModalContent(index) {
                if (index < 0 || index >= galleryData.length || !modalImageElement) return;
                const data = galleryData[index];
                // Preload next/prev images slightly? Maybe too complex for now.
                modalImageElement.src = data.largeSrc;
                modalImageElement.alt = data.title;
                if (modalTitleElement) modalTitleElement.textContent = data.title;
                if (modalCaptionElement) modalCaptionElement.textContent = data.category;
            }

            function showPreviousImage() {
                currentImageIndex = (currentImageIndex - 1 + galleryData.length) % galleryData.length; // Loop safely
                updateModalContent(currentImageIndex);
            }

            function showNextImage() {
                currentImageIndex = (currentImageIndex + 1) % galleryData.length; // Loop safely
                updateModalContent(currentImageIndex);
            }

            // --- Swipe Gesture Handlers ---
            function handleTouchStart(evt) {
                // Use changedTouches[0] as it represents the first finger that started the touch
                touchStartX = evt.changedTouches[0].clientX;
            }

            function handleTouchMove(evt) {
                // We store the end coordinate on move to potentially check during move,
                // but the main logic happens on touchend.
                // Prevent scroll only if swiping horizontally enough? Might be complex.
                // For simplicity, we just record the endpoint here.
                touchEndX = evt.changedTouches[0].clientX;
            }

            function handleTouchEnd(evt) {
                // Check if touchEndX was updated (i.e., a move happened)
                if (touchEndX === 0) return; // No move detected

                const deltaX = touchEndX - touchStartX;

                if (Math.abs(deltaX) > SWIPE_THRESHOLD) { // Check if swipe distance is significant
                    if (deltaX < 0) {
                        // Swipe Left
                        showNextImage();
                    } else {
                        // Swipe Right
                        showPreviousImage();
                    }
                }

                // Reset touch coordinates for the next swipe
                touchStartX = 0;
                touchEndX = 0;
            }

        }); // End DOMContentLoaded

    </script>
</body>

</html>